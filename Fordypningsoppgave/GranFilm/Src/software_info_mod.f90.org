!
! $Id:$
!
! $HeadURL: file: $
!
!

Module Software_Info_Mod

  ! --------------------------------------------------------
  ! --- This module is used to give some common info about
  !     the software that it is part off......
  !
  !     Ingve Simonsen, Paris Mar 2007
  !
  ! --------------------------------------------------------




  ! ---------------------------
  ! --- The use statement
  ! ---------------------------

  
  ! --------------------------------------
  ! --- The Publicly avaiable quantities
  ! --------------------------------------
  Public :: Software_Info_Type
  Public :: Software_Info_Set
  Public :: Software_Info_String

  
  ! --------------------------------------
  ! --- Everyting is Private by default
  ! --------------------------------------
  Private


  ! --------------------------------------------
  ! --- Define default parameter settings
  ! --------------------------------------------

  Integer, parameter :: STR_LEN=100
  !
  Type Software_Info_Type
     Character(len=STR_LEN)    ::  Name       ! Software name
     Character(len=STR_LEN)    ::  Author     ! Software author
     Character(len=STR_LEN)    ::  Email      ! Software author email
     Character(len=STR_LEN)    ::  CopyRight    
     Character(len=STR_LEN)    ::  Version    ! Software Version  
     Character(len=STR_LEN)    ::  Revision   ! Software Revision
     Integer                   ::  FromYear   ! Start year for the code....  
  End Type Software_Info_Type


  !
  ! ------------------------
  !
  
Contains


  !----------------------------------------!
  Subroutine Software_Info_Set( Info, Name )
  !----------------------------------------!
    !
    ! Set some information about the software
    !
    Implicit None
    Type(Software_Info_Type), intent(inout)               :: Info
    Character(len=*),         intent(in),   optional      :: Name
    ! Local
    Integer :: ipos
    Character(len=100) :: Software_Name

    ! Set the name of the Software.....
    if (present(Name) ) then
       Info%Name       = Trim(Adjustl(Name))
    else
       call getarg(0, Software_Name )  
       Info%Name       = Trim(adjustl( Software_Name ))  
    end if

   
    ! --- Some Defaults....
    Info%Version    = "2.0"
    Info%Author     = "Ingve Simonsen <Ingve.Simonsen@ntnu.no> and Remi Lazzari <Remi.Lazzari@insp.jussieu.fr>"
    Info%Revision   = Get_SVN_Revision_Number()
    Info%Copyright  = "Copyright (C) 1998--2010"
                        !  Should be : Copyright (C) 2008--<to year>....  

    

  contains
    

    Function Get_SVN_Revision_Number() result(res)
      ! This routine gets the SVN Revison number 
      ! from the file VERSION (if it exists)
      Implicit None
      character(len=15) :: res
      ! Local
      character(len=100):: svn_revision
      
      ! This file is automatically generated by the made file 
      Include ".svn_revision"

      res  = trim(adjustl(svn_revision))

      !Integer    :: istart, iend
      !character(len=*),parameter :: REV="$Rev: 59 $"
      !character(len=*),parameter :: tag="$Rev:"
  
      !istart = Index( REV, tag) + len(tag)
      !iend   = Index( REV(istart+1:), " " ) + istart
      !res = REV(istart:iend)
      
    End Function Get_SVN_Revision_Number


  End subroutine Software_Info_Set
  !-------------------------------!



  !--------------------------------------------!
  Subroutine Software_Info_String(Info, string)
  !--------------------------------------------!
    !
    ! Returns a info string about the softaware....
    ! Eg. Name, Version and revision
    !
    Implicit None
    Type(Software_Info_Type), intent(inout) :: Info
    Character(len=*),         intent(out)   :: string

   string = " "//trim(Adjustl(Info%Name))//" version "//trim(adjustl(Info%Version))//" (hg:"//trim(adjustl(Info%Revision))//")"  &
         // "\n\n Copyright (C) 1998--2012"    &
         // "\n\nIngve Simonsen <Ingve.Simonsen@ntnu.no> and Remi Lazzari <Remi.Lazzari@insp.jussieu.fr>"


    return

  End Subroutine Software_Info_String
  !----------------------------------!

End Module Software_Info_Mod

